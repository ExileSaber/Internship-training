import matplotlib.pyplot as plt
import numpy as np


def Function_fit(Time_list):
    Time = []
    Price = []
    for i in range(len(Time_list)):
        K = Time_list[i].keys()
        Key = list(K)
        time = Key[0].split('：')[-1]
        Time.append(time)
        Price.append(Time_list[i][Key[0]])

    x = np.arange(len(Time))
    y = Price

    plt.rcParams['figure.figsize'] = (24.0, 6.0)
    z1 = np.polyfit(x, y, 8)  # 用3次多项式拟合
    p1 = np.poly1d(z1)
    print(p1)  # 在屏幕上打印拟合多项式
    yvals = p1(x)  # 也可以使用yvals=np.polyval(z1,x)
    plot1 = plt.plot(x, y, 'o-', label='original values')
    plot2 = plt.plot(x, yvals, 'r', label='polyfit values')
    plt.xlabel('x axis')
    plt.ylabel('y axis')
    plt.legend(loc=4)  # 指定legend的位置,读者可以自己help它的用法
    plt.title('polyfitting')
    plt.show()


time_list = [{'北京:2017-08-06': 70132}, {'北京:2017-08-13': 72208}, {'北京:2017-08-20': 70189}, {'北京:2017-08-27': 69426}, {'北京:2017-09-03': 68848}, {'北京:2017-09-10': 70870}, {'北京:2017-09-17': 71234}, {'北京:2017-09-24': 71472}, {'北京:2017-10-01': 71274}, {'北京:2017-10-08': 70745}, {'北京:2017-10-15': 69900}, {'北京:2017-10-22': 67867}, {'北京:2017-10-29': 66534}, {'北京:2017-11-05': 65703}, {'北京:2017-11-12': 63807}, {'北京:2017-11-19': 63190}, {'北京:2017-11-26': 62087}, {'北京:2017-12-03': 60292}, {'北京:2017-12-10': 60319}, {'北京:2017-12-17': 58589}, {'北京:2017-12-24': 57852}, {'北京:2017-12-31': 57970}, {'北京:2018-01-07': 59739}, {'北京:2018-01-14': 59339}, {'北京:2018-01-21': 58501}, {'北京:2018-01-28': 60245}, {'北京:2018-02-04': 58550}, {'北京:2018-02-11': 60279}, {'北京:2018-02-18': 59911}, {'北京:2018-02-25': 59810}, {'北京:2018-03-04': 59697}, {'北京:2018-03-11': 59074}, {'北京:2018-03-18': 60807}, {'北京:2018-03-25': 61403}, {'北京:2018-04-01': 60786}, {'北京:2018-04-08': 59709}, {'北京:2018-04-15': 61446}, {'北京:2018-04-22': 61933}, {'北京:2018-04-29': 62060}, {'北京:2018-05-06': 60351}, {'北京:2018-05-13': 60027}, {'北京:2018-05-20': 58388}, {'北京:2018-05-27': 60077}, {'北京:2018-06-03': 60728}, {'北京:2018-06-10': 59084}, {'北京:2018-06-17': 60778}, {'北京:2018-06-24': 60572}, {'北京:2018-07-01': 58928}, {'北京:2018-07-08': 58990}, {'北京:2018-07-15': 60667}, {'北京:2018-07-22': 59678}, {'北京:2018-07-29': 58071}, {'北京:2018-08-05': 59726}, {'北京:2018-08-12': 59598}, {'北京:2018-08-19': 58006}, {'北京:2018-08-26': 57735}, {'北京:2018-09-02': 56191}, {'北京:2018-09-09': 57072}, {'北京:2018-09-16': 58669}, {'北京:2018-09-23': 57113}, {'北京:2018-09-30': 56912}, {'北京:2018-10-07': 55400}, {'北京:2018-10-14': 56137}, {'北京:2018-10-21': 55500}, {'北京:2018-10-28': 55094}, {'北京:2018-11-04': 54474}, {'北京:2018-11-11': 55234}, {'北京:2018-11-18': 53707}, {'北京:2018-11-25': 54695}, {'北京:2018-12-02': 53182}, {'北京:2018-12-09': 53771}, {'北京:2018-12-16': 55332}, {'北京:2018-12-23': 53813}, {'北京:2018-12-30': 54847}, {'北京:2019-01-06': 55253}, {'北京:2019-01-13': 55470}, {'北京:2019-01-20': 53923}, {'北京:2019-01-27': 54094}, {'北京:2019-02-03': 52587}, {'北京:2019-02-10': 52649}, {'北京:2019-02-17': 52595}, {'北京:2019-02-24': 52762}, {'北京:2019-03-03': 54331}, {'北京:2019-03-10': 53986}, {'北京:2019-03-17': 52459}, {'北京:2019-03-24': 52761}, {'北京:2019-03-31': 53606}, {'北京:2019-04-07': 53462}, {'北京:2019-04-14': 52589}, {'北京:2019-04-21': 52935}, {'北京:2019-04-28': 52952}, {'北京:2019-05-05': 52924}, {'北京:2019-05-12': 52877}, {'北京:2019-05-19': 53174}, {'北京:2019-05-26': 52606}, {'北京:2019-06-02': 52870}, {'北京:2019-06-09': 53639}, {'北京:2019-06-16': 53841}, {'北京:2019-06-23': 54791}, {'北京:2019-06-30': 54708}, {'北京:2019-07-07': 53131}, {'北京:2019-07-14': 52709}, {'北京:2019-07-21': 52706}, {'北京:2019-07-28': 52378}]

if __name__ == '__main__':
    Function_fit(time_list)
